#include <stdio.h>
#include <string.h>

int main(int argc, char *argv[]) {
	int value = 5;
	char buffer_one[8], buffer_two[8];

	strcpy(buffer_one, "one"); /* put "one" into buffer_one */
	strcpy(buffer_two, "two"); /* put "two" into buffer_two */
	
	printf("[BEFORE] buffer_two is at %p and contains \'%s\'\n", buffer_two, buffer_two);
	printf("[BEFORE] buffer_one is at %p and contains \'%s\'\n", buffer_one, buffer_one);
	printf("[BEFORE] value is at %p and is %d (0x%08x)\n", &value, value, value);

	printf("\n[STRCPY] copying %d bytes into buffer_two\n\n",  strlen(argv[1]));
	strcpy(buffer_two, argv[1]); /* copy first argument into buffer_two */

	printf("[AFTER] buffer_two is at %p and contains \'%s\'\n", buffer_two, buffer_two);
	printf("[AFTER] buffer_one is at %p and contains \'%s\'\n", buffer_one, buffer_one);
	printf("[AFTER] value is at %p and is %d (0x%08x)\n", &value, value, value);
}

===================OUTPUT================================================
#cd Desktop
#gcc -o overflow_example overflow_example.c

#./a.out
[BEFORE] buffer_two is at 0x7ffd6e0a30bc and contains 'two'
[BEFORE] buffer_one is at 0x7ffd6e0a30c4 and contains 'one'
[BEFORE] value is at 0x7ffd6e0a30cc and is 5 (0x00000005)
segmentation fault 

#./a.out 1234567890
./a.out 1234567890
[BEFORE] buffer_two is at 0x7ffd43d416e0 and contains 'two'
[BEFORE] buffer_one is at 0x7ffd43d416f0 and contains 'one'
[BEFORE] value is at 0x7ffd43d416fc and is 5 (0x00000005)

[STRCPY] copying 10 bytes into buffer_two

[AFTER] buffer_two is at 0x7ffd43d416e0 and contains '1234567890'
[AFTER] buffer_one is at 0x7ffd43d416f0 and contains 'one'
[AFTER] value is at 0x7ffd43d416fc and is 5 (0x00000005)

Notice that buffer_one is located directly after buffer_two in memory, so
when ten bytes are copied into buffer_two , the last two bytes of 90 overflow
into buffer_one and overwrite whatever was there.

#./a.out 1234567890 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
[BEFORE] buffer_two is at 0x7ffda4b18e7c and contains 'two'
[BEFORE] buffer_one is at 0x7ffda4b18e84 and contains 'one'
[BEFORE] value is at 0x7ffd74818a3c and is 5 (0x00000005)

[STRCPY] copying 29 bytes into buffer_two

[AFTER] buffer_two is at 0x7ffda4b18e7c and contains ' AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
[AFTER] buffer_one is at 0x7ffda4b18e84 and contains ' AAAAAAAAAAAAAA'
[AFTER] value is at 0x7ffd74818a3c and is 5 (0x41414141)
Segmentation fault (core dumped)

These types of program crashes are fairly common—think of all of the
times a program has crashed or blue-screened on you. The programmer’s
mistake is one of omission—there should be a length check or restriction on
the user-supplied input.
