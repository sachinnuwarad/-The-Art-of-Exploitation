#define _XOPEN_SOURCE
#include <unistd.h>
#include <stdio.h>

/* barf a message and exit */
void barf(char *message, char *extra) {
   printf(message, extra);
   exit(1);
}

/* a dictionary attack example program */
int main(int argc, char *argv[]) {
   FILE *wordlist;
   char *hash, word[30], salt[3];
   if(argc < 2) 
      barf("Usage: %s <wordlist file> <password hash>\n", argv[0]);

   strncpy(salt, argv[2], 2); // first 2 bytes of hash are the salt
   salt[2] = '\0';  // terminate string

   printf("Salt value is \'%s\'\n", salt);

   if( (wordlist = fopen(argv[1], "r")) == NULL) // open the wordlist
      barf("Fatal: couldn't open the file \'%s\'.\n", argv[1]);
   
   while(fgets(word, 30, wordlist) != NULL) { // read each word
      word[strlen(word)-1] = '\0'; // remove the '\n' byte at the end
      hash = crypt(word, salt); // hash the word using the salt
      printf("trying word:   %-30s ==> %15s\n", word, hash);
      if(strcmp(hash, argv[2]) == 0) { // if the hash matches
         printf("The hash \"%s\" is from the ", argv[2]);
         printf("plaintext password \"%s\".\n", word);
         fclose(wordlist);
         exit(0);
      }
   }
   printf("Couldn't find the plaintext password in the supplied wordlist.\n");
   fclose(wordlist);
}

==========================================OUTPUT==============================================
#cd Desktop
#gcc -o crypt_crack crypt_crack.c -lcrypt
 
 you can see the excuteable file created 

./crypt_crack /usr/share/dict/words jeHEAX1m66RV Salt value is 'je'

its going to try to fetch the all word present the dict/wordslist file  

we are getting the jeHEAX1m66RV bcoz we have enter it before in another program excution terminal  

atlast The hash "jeHEAX1m66RV" is from the plaintext password "test"

The downside to this attack is that if the original password isn’t a word
found in the dictionary file, the password won’t be found. For example, if a
non-dictionary word such as h4R% is used as a password, the dictionary attack
won’t be able to find it:

./crypt_test h4R% je
password "h4R%" with salt "je" hashes to ==> jeMqqfIfPNNTE


this is try to commpare the word password and hash word

final i get the out couldn't find the plaintext password in the supplied wordlist

./crypt_crack /usr/share/dict/words jeMqqfuFPNNTE

 Couldn't find the plaintext password in the supplied wordlist.
